<!DOCTYPE html>
<html lang="en">

<head>
	<link rel="icon" href="images/icons/dw_icon_small.png?v=2" type="image/png" />
	<link rel="apple-touch-icon" href="images/icons/dw_icon.png?v=2" type="image/png" />

	<meta charset="UTF-8" />
	<meta name="description" content="Welcome to the unofficial Dungeon World Character sheet!" />
	<meta name="author" content="Godmar02" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />

	<meta property="og:url" content="https://github.com/godmar02/godmar02.github.io" />
	<meta property="og:type" content="website" />
	<meta property="og:title" content="Dungeon World Character Sheet" />
	<meta property="og:description" content="Welcome to the unofficial Dungeon World Character sheet!" />
	<meta property="og:image" content="https://github.com/godmar02/godmar02.github.io/images/icons/dw_icon.png" />

	<title>Dungeon World Character Sheet</title>

	<style>
		h2 {
			display: inline;
		}

		p {
			max-height: 999999px;
			font-size: 17px;
			margin-top: 12px;
			margin-bottom: 12px;
			display: table-row;
		}

		p.ext {
			font-size: 16px;
		}

		p.i {
			font-style: italic;
		}

		div.a {
			border-bottom: 1px solid;
			float: left;
			display: none;
			width: 100%;
		}

		div.c {
			font-size: 13px;
			max-height: 999999px;
		}

		div.ei {
			text-align: right;
			padding-right: 8px;
			float: right;
			width: 1%;
		}

		div.p {
			font-size: 17px;
			float: left;
			width: 92%;
		}

		div.q {
			border-bottom: 1px solid;
			padding-top: 14px;
			padding-bottom: 14px;
			float: left;
			width: 100%
		}

		.textpress {
			padding-top: 4px;
			padding-bottom: 4px;
		}

		.textpress:active {
			background-color: lightgray;
		}

		#respressindicator {
			visibility: hidden;
		}

		#resultcontainer:active #respressindicator {
			visibility: visible;
		}

		.container {
			display: inline-block;
			position: relative;
			cursor: pointer;
			height: 40px;
			font-size: 17px;
			border: 1px solid #A9A9A9;
			padding-top: 10px;
			padding-bottom: 6px;
			padding-left: 2px;
			padding-right: 2px;
			box-sizing: border-box;
			-moz-appearance: none;
			-webkit-appearance: none;
			appearance: none;
		}

		.container:active {
			background-color: lightgray;
		}

		.shiphpcontainer {
			display: inline-block;
			cursor: pointer;
			font-size: 17px;
			border: 1px solid #A9A9A9;
			width: 39px;
			height: 40px;
			padding-top: 10px;
			padding-bottom: 6px;
			padding-left: 2px;
			padding-right: 2px;
			text-align: center;
			box-sizing: border-box;
			-moz-appearance: none;
			-webkit-appearance: none;
			appearance: none;
		}

		.creationcontainer {
			display: inline-block;
			cursor: pointer;
			font-size: 17px;
			border: 1px solid #A9A9A9;
			width: 28px;
			padding-top: 4px;
			padding-bottom: 4px;
			padding-left: 1px;
			padding-right: 1px;
			-moz-appearance: none;
			-webkit-appearance: none;
			appearance: none;
		}

		.container input {
			position: absolute;
			cursor: pointer;
			height: 0;
			width: 0;
		}

		.checkmark {
			position: absolute;
			height: 18px;
			width: 18px;
			top: 10px;
			right: 2px;
			background-color: #eee;
			border: 1px solid #696969;
			border-radius: 5px;
		}

		.checkmark:after {
			content: "";
			position: absolute;
			display: none;
		}

		.container input:checked~.checkmark:after {
			display: block;
		}

		.container .checkmark:after {
			left: 6px;
			top: 2px;
			width: 4px;
			height: 9px;
			border: solid black;
			border-width: 0 3px 3px 0;
			transform: rotate(45deg);
			-webkit-transform: rotate(45deg);
			-ms-transform: rotate(45deg);
		}

		input[type=number] {
			display: inline-block;
			border: 1px solid #A9A9A9;
			padding-top: 4px;
			padding-bottom: 4px;
			padding-left: 1px;
			padding-right: 1px;
			border-radius: 0;
			font-size: 17px;
			-moz-appearance: none;
			-webkit-appearance: none;
			appearance: none;
		}

		form {
			display: table;
		}

		label {
			display: table-cell;
		}

		input {
			display: table-cell;
		}

		select {
			position: relative;
			width: 135px;
			height: 40px;
			font-size: 17px;
			display: inline-block;
			border: 1px solid #A9A9A9;
			display: table-cell;
			padding-left: 1px;
			padding-right: 2px;
			padding-top: 5px;
			padding-bottom: 5px;
			border-radius: 0;
			background: url(images/icons/down_arrow.png) no-repeat right;
			box-sizing: border-box;
			-moz-appearance: none;
			-webkit-appearance: none;
			appearance: none;
		}

		select::-ms-expand {
			display: none;
		}

		button {
			font-size: 17px;
			background-color: #eee;
			color: black;
			padding: 7px 11px;
			border: 1px solid #696969;
			border-radius: 5px;
			cursor: pointer;
		}

		button:active {
			background-color: lightgray;
		}
	</style>

</head>

<body onload="loadelements()">
	<script>
		var extinfo = [];
		var tapcounter = 0;
		var entries = 10;
		var attackers = [];
		var defenders = [];
		var attackerselected = -1;
		var defenderselected = -1;
		var prevattackerselected = -2;
		var prevdefenderselected = -2;
		var deleteselected = false;
		var healselected = false;
		var backupattackers = [];
		var backupdefenders = [];
		var firstbackup = false;
		var noretalswitch = true;
		var answersexpanded = 0;
		var refreshcounter = 0;
		var refatthpcounter = 0;
		var refdefhpcounter = 0;
		var shortparameter = false;
		var savednumber = 0;
		var freezecounter = 0;

		function messageclear() {
			document.getElementById("resultatt").innerHTML = "";
			document.getElementById("resultdef").innerHTML = "";
			document.getElementById("resultsplash").innerHTML = "";
			document.getElementById("note").innerHTML = "";
			document.getElementById("frozennote").innerHTML = "";
		}

		function calculate(mode) {
			var attforce, defforce, totaldam, res, testdef, multitestdef;
			var astring, bstring, cstring, unit1, unit2, defbonus = "";
			var warning = false;

			if (mode == "Multi") {
				var att = attackers[attackerselected].a;
				var def = defenders[defenderselected].d;
				var atthp = parseInt(attackers[attackerselected].hp);
				var defhp = parseInt(defenders[defenderselected].hp);
				var splashhp = parseInt(defenders[defenderselected].hp);
				var attorighp = parseInt(attackers[attackerselected].originalhp);
				var attmaxhp = attackers[attackerselected].maxhp;
				var defmaxhp = defenders[defenderselected].maxhp;
				var attname = attackers[attackerselected].type;
				var defname = defenders[defenderselected].type;
			} else {
				var att = parseFloat(document.getElementById("attack").value);
				var def = parseFloat(document.getElementById("defense").value);
				var atthp = parseInt(document.getElementById("attackhp").value);
				var defhp = parseInt(document.getElementById("defensehp").value);
				var splashhp = parseInt(document.getElementById("defensehp").value);
				var attmaxhp = parseInt(document.getElementById("attackmaxhp").value);
				var defmaxhp = parseInt(document.getElementById("defensemaxhp").value);
				var attname = document.getElementById("selectClass").value;
				var defname = document.getElementById("selectdefender").value;
			}
			resetcounters();
			if (atthp == 123) {
				messageclear();
				warning = true;
				defhp = parseInt(document.getElementById("defensehp").value);
				if (defhp == 0) {
					document.getElementById("resultatt").innerHTML = "Combat history must contain at least 1 entry!";
					scrollanchor.scrollIntoView(false);
				} else {
					if (defhp == 1) {
						document.getElementById("resultatt").innerHTML = "Combat history limit set to 1 entry!";
					} else {
						document.getElementById("resultatt").innerHTML = "Combat history limit set to " + defhp + " entries!";
					}
					extinfo.splice(defhp, (extinfo.length - 1));
					document.getElementById("extendedinfo").innerHTML = extinfo.join("");
					entries = defhp;
					if (extinfo.length == 0) {
						document.getElementById("extendedinfo").innerHTML = "<span style='border-top: 1px dashed black; padding-top: 10px; display: block; max-width: 350px;'></span><span class='ext'>Battle history does not contain any entries yet.</span>";
					}
					scrollanchor.scrollIntoView(false);
				}
			}
			if ((mode != "Multi") && (warning != true)) {
				if (isNaN(att) == true || isNaN(def) == true || isNaN(atthp) == true ||
					isNaN(defhp) == true || isNaN(attmaxhp) == true || isNaN(defmaxhp) == true) {
					warning = true;
					messageclear();
					document.getElementById("resultatt").innerHTML = "All of the fields have to be filled with numbers!";
					scrollanchor.scrollIntoView(false);
				} else if (att < 0 || def < 0 || atthp < 1 || defhp < 1 || attmaxhp < 10 || defmaxhp < 10 || atthp > attmaxhp || defhp > defmaxhp ||
					(att % 0.5 != 0) || (def % 0.5 != 0) || (document.getElementById("attackhp").value % atthp != 0) || (document.getElementById("defensehp").value % defhp != 0) ||
					(document.getElementById("attackmaxhp").value % attmaxhp != 0) || (document.getElementById("defensemaxhp").value % defmaxhp != 0)) {
					warning = true;
					messageclear();
					document.getElementById("resultatt").innerHTML = "One or more invalid inputs:<br/>";
					if (att < 0) {
						resultatt.insertAdjacentHTML("beforeend", "<br/>- Attack value must be 0 or higher");
					} else if (att % 0.5 != 0) {
						resultatt.insertAdjacentHTML("beforeend", "<br/>- Attack value must be divisible by 0.5");
					}
					if (atthp < 1) {
						resultatt.insertAdjacentHTML("beforeend", "<br/>- Attacker current HP can't be lower than 1");
					} else if (document.getElementById("attackhp").value % atthp != 0) {
						resultatt.insertAdjacentHTML("beforeend", "<br/>- Attacker current HP must be a whole number");
					} else if (atthp > attmaxhp && atthp > 0 && attmaxhp >= 10) {
						resultatt.insertAdjacentHTML("beforeend", "<br/>- Attacker current HP cannot exceed max HP");
					}
					if (attmaxhp < 10) {
						resultatt.insertAdjacentHTML("beforeend", "<br/>- Attacker max HP must be 10 or higher");
					} else if (document.getElementById("attackmaxhp").value % attmaxhp != 0) {
						resultatt.insertAdjacentHTML("beforeend", "<br/>- Attacker max HP must be a whole number");
					}
					if (def < 0) {
						resultatt.insertAdjacentHTML("beforeend", "<br/>- Defense value must be 0 or higher");
					} else if (def % 0.5 != 0) {
						resultatt.insertAdjacentHTML("beforeend", "<br/>- Defense value must be divisible by 0.5");
					}
					if (defhp < 1) {
						resultatt.insertAdjacentHTML("beforeend", "<br/>- Defender current HP can't be lower than 1");
					} else if (document.getElementById("defensehp").value % defhp != 0) {
						resultatt.insertAdjacentHTML("beforeend", "<br/>- Defender current HP must be a whole number");
					} else if (defhp > defmaxhp && defhp > 0 && defmaxhp >= 10) {
						resultatt.insertAdjacentHTML("beforeend", "<br/>- Defender current HP cannot exceed max HP");
					}
					if (defmaxhp < 10) {
						resultatt.insertAdjacentHTML("beforeend", "<br/>- Defender max HP must be 10 or higher");
					} else if (document.getElementById("defensemaxhp").value % defmaxhp != 0) {
						resultatt.insertAdjacentHTML("beforeend", "<br/>- Defender max HP must be a whole number");
					}
					scrollanchor.scrollIntoView(false);
				}
			}
			if (warning != true) {
				messageclear();
				testdef = false;
				if (mode == "Multi") {
					multitestdef = defenders[defenderselected].defbonus;
					if (multitestdef == "D") {
						testdef = true;
					}
				} else {
					testdef = document.getElementById("def1").checked;
				}
				if ((mode == "Multi") && (attname == "Fire Dragon") && (attackers[attackerselected].defendersattacked.length > 0)) {
					atthp = attorighp;
				}
				attforce = att * (atthp / attmaxhp);
				defforce = def * (defhp / defmaxhp);

				if (testdef == true) {
					if (defname == "Catapult") {
						document.getElementById("note").innerHTML = "Note: Catapults can't benefit any from defense bonuses due to their 0 defense value!";
					} else if (defname == "Mind Bender") {
						defforce = defforce * 1.5;
						document.getElementById("note").innerHTML = "Note: Mind Benders don't receive the defense bonus from cities!";
					} else if (defname == "Giant") {
						defforce = defforce * 1.5;
						document.getElementById("note").innerHTML = "Note: Giants don't receive the defense bonus from cities!";
					} else if (defname == "Navalon") {
						defforce = defforce * 1.5;
						document.getElementById("note").innerHTML = "Note: Navalons don't receive the defense bonus from cities!";
					} else if (defname == "Baby Dragon") {
						defforce = defforce * 1.5;
						document.getElementById("note").innerHTML = "Note: Baby Dragons don't receive the defense bonus from cities!";
					} else if (defname == "Fire Dragon") {
						defforce = defforce * 1.5;
						document.getElementById("note").innerHTML = "Note: Fire Dragons don't receive the defense bonus from cities!";
					} else if (defname == "Crab") {
						defforce = defforce * 1.5;
						document.getElementById("note").innerHTML = "Note: Crabs don't receive the defense bonus from cities!";
					} else if (defname == "Mooni") {
						defforce = defforce * 1.5;
						document.getElementById("note").innerHTML = "Note: Moonies don't receive the defense bonus from cities!";
					} else if (defname == "Battle Sled") {
						defforce = defforce * 1.5;
						document.getElementById("note").innerHTML = "Note: Battle Sleds don't receive the defense bonus from cities!";
					} else if (defname == "Ice Fortress") {
						defforce = defforce * 1.5;
						document.getElementById("note").innerHTML = "Note: Ice Fortresses don't receive the defense bonus from cities!";
					} else if (defname == "Gaami") {
						defforce = defforce * 1.5;
						document.getElementById("note").innerHTML = "Note: Gaamis don't receive the defense bonus from cities!";
					} else if (defname == "Nature Bunny") {
						document.getElementById("note").innerHTML = "Note: Nature Bunnies can't capture cities and don't have any defensive technologies! Defense bonus was disregarded in the result.";
					} else {
						defforce = defforce * 1.5;
						defbonus = "|D";
					}
				}
				testdef = false;
				if (mode == "Multi") {
					multitestdef = defenders[defenderselected].defbonus;
					if (multitestdef == "W") {
						testdef = true;
					}
				} else {
					testdef = document.getElementById("def2").checked;
				}
				if (testdef == true) {
					if (defname == "Boat" || defname == "Ship" || defname == "Battleship") {
						document.getElementById("note").innerHTML = "Note: Ships can't benefit from walls! Wall bonus was disregarded in the result.";
					} else if (defname == "Catapult") {
						document.getElementById("note").innerHTML = "Note: Catapults can't benefit from any defense bonuses due to their 0 defense value!";
					} else if (defname == "Mind Bender") {
						document.getElementById("note").innerHTML = "Note: Mind Benders don't receive the defense bonus from cities! Wall bonus was disregarded in the result.";
					} else if (defname == "Giant") {
						document.getElementById("note").innerHTML = "Note: Giants don't receive the defense bonus from cities! Wall bonus was disregarded in the result.";
					} else if (defname == "Navalon") {
						document.getElementById("note").innerHTML = "Note: Navalons don't receive the defense bonus from cities! Wall bonus was disregarded in the result.";
					} else if (defname == "Baby Dragon") {
						document.getElementById("note").innerHTML = "Note: Baby Dragons don't receive the defense bonus from cities! Wall bonus was disregarded in the result.";
					} else if (defname == "Fire Dragon") {
						document.getElementById("note").innerHTML = "Note: Fire Dragons don't receive the defense bonus from cities! Wall bonus was disregarded in the result.";
					} else if (defname == "Crab") {
						document.getElementById("note").innerHTML = "Note: Crabs don't receive the defense bonus from cities! Wall bonus was disregarded in the result.";
					} else if (defname == "Mooni") {
						document.getElementById("note").innerHTML = "Note: Moonies don't receive the defense bonus from cities! Wall bonus was disregarded in the result.";
					} else if (defname == "Battle Sled") {
						document.getElementById("note").innerHTML = "Note: Battle Sleds don't receive the defense bonus from cities! Wall bonus was disregarded in the result.";
					} else if (defname == "Ice Fortress") {
						document.getElementById("note").innerHTML = "Note: Ice Fortresses don't receive the defense bonus from cities! Wall bonus was disregarded in the result.";
					} else if (defname == "Gaami") {
						document.getElementById("note").innerHTML = "Note: Gaamis don't receive the defense bonus from cities! Wall bonus was disregarded in the result.";
					} else if (defname == "Nature Bunny") {
						document.getElementById("note").innerHTML = "Note: Nature Bunnies can't capture cities! Wall bonus was disregarded in the result.";
					} else {
						defforce = defforce * 4;
						defbonus = "|W";
					}
				}

				unit1 = attname + " " + att + "|" + atthp + "|" + attmaxhp + " - ";
				unit2 = defname + " " + def + "|" + defhp + "|" + defmaxhp + defbonus;

				totaldam = attforce + defforce;
				res = Math.round(attforce / totaldam * att * 4.5);
				if (isNaN(res) == true) {
					res = 0;
				}
				if (attname == "Fire Dragon") {
					splashhp = splashhp - Math.floor(res / 2);
					if (splashhp > 0) {
						if (mode != "Multi") {
							cstring = document.getElementById("resultsplash").innerHTML = "<p><i>IF SPLASHED:</i></p>Defender survives! Remaining HP:  " + splashhp;
						} else if (attackers[attackerselected].defendersattacked.length > 0) {
							cstring = document.getElementById("resultsplash").innerHTML = "<i>Fire Dragon's splash attack.</i>";
						} else if (attackers[attackerselected].defendersattacked.length < 1) {
							if (document.getElementById("noretalbox").checked == true) {
								cstring = document.getElementById("resultsplash").innerHTML = "<i><p>Fire Dragon's main attack.</p>No enemy retaliation.</i>";
							} else {
								cstring = document.getElementById("resultsplash").innerHTML = "<i>Fire Dragon's main attack.</i>";
							}
						}
					} else {
						if (mode != "Multi") {
							cstring = document.getElementById("resultsplash").innerHTML = "<p><i>IF SPLASHED:</i></p>Defender is DESTROYED! Afterlife HP:  " + splashhp;
						} else if (attackers[attackerselected].defendersattacked.length > 0) {
							cstring = document.getElementById("resultsplash").innerHTML = "<i>Fire Dragon's splash attack.</i>";
						} else if (attackers[attackerselected].defendersattacked.length < 1) {
							if (document.getElementById("noretalbox").checked == true) {
								cstring = document.getElementById("resultsplash").innerHTML = "<i><p>Fire Dragon's main attack.</p>No enemy retaliation.</i>";
							} else {
								cstring = document.getElementById("resultsplash").innerHTML = "<i>Fire Dragon's main attack.</i>";
							}
						}
					}
				}
				if ((attname == "Fire Dragon") && (mode == "Multi")) {
					if (attackers[attackerselected].defendersattacked.length > 0) {
						defhp = splashhp;
					} else {
						defhp = defhp - res;
					}
				} else {
					defhp = defhp - res;
				}

				if (mode != "Multi") {
					if (defhp > 0) {
						if (attname == "Ice Archer") {
							bstring = document.getElementById("resultdef").innerHTML = "Defender is FROZEN! Remaining HP:  " + defhp;
							document.getElementById("frozennote").innerHTML = "Frozen units can't retaliate!";
						} else {
							bstring = document.getElementById("resultdef").innerHTML = "Defender survives! Remaining HP:  " + defhp;
							document.getElementById("defensehp").value = defhp;
						}
						res = Math.round(defforce / totaldam * def * 4.5);
						if (isNaN(res) == true) {
							res = 0;
						}
						if (attname == "Ice Archer" || defname == "Mooni" || defname == "Ice Archer") {
							res = 0;
							if (defname == "Mooni") {
								document.getElementById("frozennote").innerHTML = "Moonies can't retaliate!";
							}
							if (defname == "Ice Archer") {
								document.getElementById("frozennote").innerHTML = "Ice Archers can't retaliate!";
							}
						}
						atthp = atthp - res;
						if (atthp > 0) {
							astring = document.getElementById("resultatt").innerHTML = "Attacker survives! Remaining HP:  " + atthp;
						} else {
							astring = document.getElementById("resultatt").innerHTML = "Attacker is DESTROYED! Afterlife HP:  " + atthp;
						}
					} else {
						bstring = document.getElementById("resultdef").innerHTML = "Defender is DESTROYED! Afterlife HP:  " + defhp;
						egg(att);
					}
				}

				if (mode == "Multi") {
					if (defhp > 0) {
						if (attname == "Ice Archer") {
							bstring = document.getElementById("resultdef").innerHTML = "Defender is FROZEN! Remaining HP:  " + defhp;
							document.getElementById("frozennote").innerHTML = "Frozen units can't retaliate!";
							defenders[defenderselected].frozen = true;
						} else {
							if (defenders[defenderselected].frozen == true) {
								bstring = document.getElementById("resultdef").innerHTML = "Defender is FROZEN! Remaining HP:  " + defhp;
							} else {
								bstring = document.getElementById("resultdef").innerHTML = "Defender survives! Remaining HP:  " + defhp;
							}
							defenders[defenderselected].hp = defhp;
							res = Math.round(defforce / totaldam * def * 4.5);
							if (defenders[defenderselected].frozen == true) {
								res = 0;
								document.getElementById("frozennote").innerHTML = "Frozen units can't retaliate!";
							} else if (defname == "Mooni" || defname == "Ice Archer") {
								res = 0;
								if (defname == "Mooni" && attackers[attackerselected].defendersattacked.length == 0) {
									document.getElementById("note").innerHTML = "Moonies can't retaliate!";
								}
								if (defname == "Ice Archer" && attackers[attackerselected].defendersattacked.length == 0) {
									document.getElementById("note").innerHTML = "Ice Archers can't retaliate!";
								}
							}
						}
						if (isNaN(res) == true) {
							res = 0;
						}
						if (document.getElementById("noretalbox").checked == false) {
							if ((attname == "Fire Dragon") && (attackers[attackerselected].defendersattacked.length > 0)) {} else {
								atthp = atthp - res;
							}
						}
						if (atthp > 0) {
							if ((attname == "Fire Dragon") && (attackers[attackerselected].defendersattacked.length > 0)) {} else {
								astring = document.getElementById("resultatt").innerHTML = "Attacker survives! Remaining HP:  " + atthp;
								attackers[attackerselected].hp = atthp;
							}
						} else {
							if ((attname == "Fire Dragon") && (attackers[attackerselected].defendersattacked.length > 0)) {} else {
								astring = document.getElementById("resultatt").innerHTML = "Attacker is DESTROYED! Afterlife HP:  " + atthp;
								attackers[attackerselected].hp = atthp;
							}
						}
					} else {
						bstring = document.getElementById("resultdef").innerHTML = "Defender is DESTROYED! Afterlife HP:  " + defhp;
						defenders[defenderselected].hp = defhp;
					}

					if ((attackers[attackerselected].type != "Knight") && (attackers[attackerselected].type != "Navalon") && (attackers[attackerselected].type != "Fire Dragon")) {
						attackers[attackerselected].unavailable = true;
					} else if (attackers[attackerselected].type == "Fire Dragon") {
						attackers[attackerselected].defendersattacked.push(defenderselected);
						document.getElementById("noretaltext").style.visibility = "hidden";
					} else {
						if ((defhp > 0) || (atthp < 1)) {
							attackers[attackerselected].unavailable = true;
						} else {
							attackers[attackerselected].defendersattacked.push(defenderselected);
						}
					}

					var decshort = "";
					var color = "black";
					if (attackers[attackerselected].type == "Knight") {
						decshort = "<b>3</b>";
					} else {
						decshort = attackers[attackerselected].a;
					}
					if ((attackers[attackerselected].hp < 1) || (attackers[attackerselected].unavailable == true)) {
						color = "gray";
					}
					var splashindicator = ""
					if ((attackers[attackerselected].type == "Fire Dragon") && (attackers[attackerselected].defendersattacked.length > 0)) {
						splashindicator = "S";
					}
					document.getElementById("attacker" + attackerselected).innerHTML = "<img src='images/Attackers/" + attackers[attackerselected].type + ".png' height='55' width='55'><div id='splash" + attackerselected +
						"' style='position: absolute; top: 1px; right: 1px'><b>" + splashindicator + "</b></div><div style='position: absolute; width: 100%; bottom: 2px; text-align: center'>" + decshort + "/" + attackers[attackerselected].hp + "/" + attackers[
							attackerselected].maxhp + "</div>";
					document.getElementById("attacker" + attackerselected).style.borderColor = color;

					color = "black"
					if (defenders[defenderselected].hp < 1) {
						color = "gray";
					} else if (defenders[defenderselected].frozen == true) {
						color = "blue";
					}
					document.getElementById("defender" + defenderselected).innerHTML = "<img src='images/Defenders/" + defenders[defenderselected].type + ".png' height='55' width='55'><div style='position: absolute; top: 1px; right: 1px'><b>" + defenders[
							defenderselected].defbonus + "</b></div><div style='position: absolute; width: 100%; bottom: 2px; text-align: center'>" + defenders[defenderselected].d + "/" + defenders[defenderselected].hp + "/" + defenders[defenderselected].maxhp +
						"</div>";
					document.getElementById("defender" + defenderselected).style.borderColor = color;

				}
				if ((mode == "Multi") && (attackers[attackerselected].type != "Fire Dragon") && (document.getElementById("noretalbox").checked == true) && (defenders[defenderselected].hp > 0)) {
					cstring = document.getElementById("resultsplash").innerHTML = "<i>No enemy retaliation.</i>";
				}
				if (mode == "Multi") {
					if ((attackers[attackerselected].type == "Archer") || (attackers[attackerselected].type == "Catapult") || (attackers[attackerselected].type == "Boat") || (attackers[attackerselected].type == "Ship") || (attackers[attackerselected].type ==
							"Battleship") || (attackers[attackerselected].type == "Tridention") || (attackers[attackerselected].type == "Ice Fortress")) {
						document.getElementById("noretalbox").checked = false;
						document.getElementById("noretaltext").style.visibility = "hidden";
					}
				}
				if (astring == null) {
					astring = "";
				}
				if (cstring == null) {
					cstring = "";
				}

				if (extinfo.length >= entries) {
					extinfo.pop();
				}
				extinfo.splice(0, 0, "<span style='border-top: 1px dashed black; display: block; max-width: 350px;'></span><p class='ext'>" + unit1 + unit2 + "</p><p class='ext'>" + astring + "</p><p class='ext'>" + bstring + "</p><p class='ext'>" + cstring +
					"</p>");
				document.getElementById("extendedinfo").innerHTML = extinfo.join("");

				if (mode != "Multi") {
					scrollanchor.scrollIntoView(false);
				}
			}
		}

		function defcheck() {
			var test = document.getElementById("def2").checked;
			if (test == true) {
				document.getElementById("def2").checked = false;
			}
		}

		function wallcheck() {
			var test = document.getElementById("def1").checked;
			if (test == true) {
				document.getElementById("def1").checked = false;
			}
		}

		function setdefbonus() {
			var test = document.getElementById("def1").checked;
			if (test == true) {
				document.getElementById("def1").checked = false;
			} else {
				document.getElementById("def1").checked = true;
			}
			defcheck();
		}

		function setwallbonus() {
			var test = document.getElementById("def2").checked;
			if (test == true) {
				document.getElementById("def2").checked = false;
			} else {
				document.getElementById("def2").checked = true;
			}
			wallcheck();
		}

		function characterFill() {
			var getattacker = document.getElementById("selectClass").value;
			switch (getattacker) {
				case "Warrior":
					document.getElementById("attack").value = "2";
					document.getElementById("attackhp").value = "10";
					document.getElementById("attackmaxhp").value = "10";
					break;
				case "Rider":
					document.getElementById("attack").value = "2";
					document.getElementById("attackhp").value = "10";
					document.getElementById("attackmaxhp").value = "10";
					break;
				case "Defender":
					document.getElementById("attack").value = "1";
					document.getElementById("attackhp").value = "15";
					document.getElementById("attackmaxhp").value = "15";
					break;
				case "Swordsman":
					document.getElementById("attack").value = "3";
					document.getElementById("attackhp").value = "15";
					document.getElementById("attackmaxhp").value = "15";
					break;
			}
			document.getElementById("shortatt").innerText = "(" + document.getElementById("attack").value + ")";
			if (getattacker == "Warrior" || getattacker == "Rider" || getattacker == "Defender" || getattacker == "Swordsman" || getattacker == "Archer" || getattacker == "Catapult" || getattacker == "Knight" || getattacker == "Amphibian" || getattacker ==
				"Tridention" || getattacker == "Battle Sled" || getattacker == "Ice Fortress") {
				document.getElementById("attvetbox").checked = false;
				document.getElementById("attveterancy").style.display = 'inline-block';
			} else if (getattacker == "Boat" || getattacker == "Ship" || getattacker == "Battleship") {
				document.getElementById("attveterancy").style.display = 'none';
			} else {
				document.getElementById("attveterancy").style.display = 'none';
			}
		}

		function attackerveteran() {
			var getattacker = document.getElementById("selectClass").value;
			var getattveterancy = document.getElementById("attvetbox").checked;
			switch (getattacker) {
				case "Warrior":
					document.getElementById("attack").value = "2";
					document.getElementById("attackhp").value = "10";
					document.getElementById("attackmaxhp").value = "10";
					break;
				case "Rider":
					document.getElementById("attack").value = "2";
					document.getElementById("attackhp").value = "10";
					document.getElementById("attackmaxhp").value = "10";
					break;
				case "Defender":
					document.getElementById("attack").value = "1";
					document.getElementById("attackhp").value = "15";
					document.getElementById("attackmaxhp").value = "15";
					break;
				case "Swordsman":
					document.getElementById("attack").value = "3";
					document.getElementById("attackhp").value = "15";
					document.getElementById("attackmaxhp").value = "15";
					break;
				case "Archer":
					document.getElementById("attack").value = "2";
					document.getElementById("attackhp").value = "10";
					document.getElementById("attackmaxhp").value = "10";
					break;
				case "Catapult":
					document.getElementById("attack").value = "4";
					document.getElementById("attackhp").value = "10";
					document.getElementById("attackmaxhp").value = "10";
					break;
				case "Knight":
					document.getElementById("attack").value = "3.5";
					document.getElementById("attackhp").value = "15";
					document.getElementById("attackmaxhp").value = "15";
					break;
				case "Amphibian":
					document.getElementById("attack").value = "2";
					document.getElementById("attackhp").value = "10";
					document.getElementById("attackmaxhp").value = "10";
					break;
				case "Tridention":
					document.getElementById("attack").value = "3";
					document.getElementById("attackhp").value = "15";
					document.getElementById("attackmaxhp").value = "15";
					break;
				case "Battle Sled":
					document.getElementById("attack").value = "3";
					document.getElementById("attackhp").value = "15";
					document.getElementById("attackmaxhp").value = "15";
					break;
				case "Ice Fortress":
					document.getElementById("attack").value = "4";
					document.getElementById("attackhp").value = "20";
					document.getElementById("attackmaxhp").value = "20";
					break;
			}
			var atthp = parseInt(document.getElementById("attackhp").value);
			var attmaxhp = parseInt(document.getElementById("attackmaxhp").value);
			if (getattveterancy == true) {
				document.getElementById("attackhp").value = atthp + 5;
				document.getElementById("attackmaxhp").value = attmaxhp + 5;
			}
		}

		function defenderveteran() {
			var getdefender = document.getElementById("selectdefender").value;
			var getdefveterancy = document.getElementById("defvetbox").checked;
			switch (getdefender) {
				case "Warrior":
					document.getElementById("defense").value = "2";
					document.getElementById("defensehp").value = "10";
					document.getElementById("defensemaxhp").value = "10";
					break;
				case "Rider":
					document.getElementById("defense").value = "1";
					document.getElementById("defensehp").value = "10";
					document.getElementById("defensemaxhp").value = "10";
					break;
				case "Defender":
					document.getElementById("defense").value = "3";
					document.getElementById("defensehp").value = "15";
					document.getElementById("defensemaxhp").value = "15";
					break;
				case "Swordsman":
					document.getElementById("defense").value = "3";
					document.getElementById("defensehp").value = "15";
					document.getElementById("defensemaxhp").value = "15";
					break;
				case "Archer":
					document.getElementById("defense").value = "1";
					document.getElementById("defensehp").value = "10";
					document.getElementById("defensemaxhp").value = "10";
					break;
				case "Catapult":
					document.getElementById("defense").value = "0";
					document.getElementById("defensehp").value = "10";
					document.getElementById("defensemaxhp").value = "10";
					break;
				case "Knight":
					document.getElementById("defense").value = "1";
					document.getElementById("defensehp").value = "15";
					document.getElementById("defensemaxhp").value = "15";
					break;
				case "Amphibian":
					document.getElementById("defense").value = "1";
					document.getElementById("defensehp").value = "10";
					document.getElementById("defensemaxhp").value = "10";
					break;
				case "Tridention":
					document.getElementById("defense").value = "1";
					document.getElementById("defensehp").value = "15";
					document.getElementById("defensemaxhp").value = "15";
					break;
				case "Battle Sled":
					document.getElementById("defense").value = "2";
					document.getElementById("defensehp").value = "15";
					document.getElementById("defensemaxhp").value = "15";
					break;
				case "Ice Fortress":
					document.getElementById("defense").value = "3";
					document.getElementById("defensehp").value = "20";
					document.getElementById("defensemaxhp").value = "20";
					break;
			}
			var defhp = parseInt(document.getElementById("defensehp").value);
			var defmaxhp = parseInt(document.getElementById("defensemaxhp").value);
			if (getdefveterancy == true) {
				document.getElementById("defensehp").value = defhp + 5;
				document.getElementById("defensemaxhp").value = defmaxhp + 5;
			}
		}

		function refreshatthp() {
			refatthpcounter++;
			if (refatthpcounter > 1) {
				refatthpcounter = 0;
				document.getElementById("attackhp").value = document.getElementById("attackmaxhp").value;
			}
		}

		function refreshdefhp() {
			refdefhpcounter++;
			if (refdefhpcounter > 1) {
				refdefhpcounter = 0;
				document.getElementById("defensehp").value = document.getElementById("defensemaxhp").value;
			}
		}

		function numberfocus(focusid) {
			resetcounters();
			savednumber = document.getElementById(focusid).value;
			document.getElementById(focusid).value = "";
			if ((shortparameter == true) || (document.getElementById("multibutton").innerText == "Single")) {
				if (focusid == "attackhp") {
					document.getElementById("attackhprem").innerText = "(" + savednumber + "/" + document.getElementById("attackmaxhp").value + ")";
				} else {
					document.getElementById("defensehprem").innerText = "(" + savednumber + "/" + document.getElementById("defensemaxhp").value + ")";
				}
			} else {
				document.getElementById(focusid + "rem").innerText = "(" + savednumber + ")";
			}
			document.getElementById(focusid + "rem").style.visibility = "visible";
		}

		function numberfocusout(focusoutid) {
			if (document.getElementById(focusoutid).value == "") {
				document.getElementById(focusoutid).value = savednumber;
			}
			document.getElementById(focusoutid + "rem").style.visibility = "hidden";
		}

		function show(shown, hidden) {
			document.body.scrollTop = document.documentElement.scrollTop = 0;
			document.getElementById(shown).style.display = 'block';
			document.getElementById(hidden).style.display = 'none';
			resetcounters();
			if ((document.getElementById("multibutton").innerText == "Single") && (deleteselected == true)) {
				messageclear();
				deleteselected = false;
				document.getElementById("deletebutton").innerText = "Delete Units";
			}
			if ((document.getElementById("multibutton").innerText == "Single") && (healselected == true)) {
				messageclear();
				healselected = false;
				document.getElementById("healbutton").innerText = "+2";
			}
			return false;
		}

		function displayextinfo() {
			tapcounter++;
			if ((tapcounter > 2) && (document.getElementById("extendedinfo").style.display == 'none')) {
				tapcounter = 0;
				document.getElementById("extendedinfo").style.display = 'block';
				if (document.getElementById("multibutton").innerText == "Single") {
					states.scrollIntoView();
				} else {
					submitbutton.scrollIntoView();
				}
			}
			if ((tapcounter > 2) && (document.getElementById("extendedinfo").style.display == 'block')) {
				tapcounter = 0;
				document.getElementById("extendedinfo").style.display = 'none';
				scrollanchor.scrollIntoView(false);
			}
		}

		function resetcounters() {
			tapcounter = 0;
			refreshcounter = 0;
			refatthpcounter = 0;
			refdefhpcounter = 0;
			freezecounters = 0;
			prevdefenderselected = -1;
		}

		function choosetype() {
			if (document.getElementById("unitselect").innerText == "Create Attacker") {
				document.getElementById("unitselect").innerText = "Create Defender";
				document.getElementById("switch1").style.visibility = "hidden";
				document.getElementById("switch2").style.visibility = "visible";
			} else {
				document.getElementById("unitselect").innerText = "Create Attacker";
				document.getElementById("switch1").style.visibility = "visible";
				document.getElementById("switch2").style.visibility = "hidden";
			}

			var unittype = document.getElementById("unitselect").innerText;
			if (unittype == "Create Attacker") {
				document.getElementById("attvalues").style.display = 'block';
				document.getElementById("attack").style.display = 'none';
				document.getElementById("attvaluetext").style.display = 'none';
				document.getElementById("attackmaxhp").style.display = 'none';
				document.getElementById("attmaxhptext").style.display = 'none';
				document.getElementById("defvalues").style.display = 'none';
			} else if (unittype == "Create Defender") {
				document.getElementById("defvalues").style.display = 'block';
				document.getElementById("defense").style.display = 'none';
				document.getElementById("defvaluetext").style.display = 'none';
				document.getElementById("defensemaxhp").style.display = 'none';
				document.getElementById("defmaxhptext").style.display = 'none';
				document.getElementById("attvalues").style.display = 'none';
				document.getElementById("def1").checked = false;
				document.getElementById("def2").checked = false;
			}
		}

		function noretalboxcheck() {
			var test = document.getElementById("noretalbox").checked;
			if (test == true) {
				document.getElementById("noretalbox").checked = false;
			} else {
				document.getElementById("noretalbox").checked = true;
			}
		}

		function defenseselector(defendernumber) {
			defenderselected = defendernumber;
			if (deleteselected == true) {
				deleteunit("Defender");
			} else if (healselected == true) {
				healunit("Defender");
			} else {
				if (attackerselected == -1 && defenders[defenderselected].hp > 0 && defenders[defenderselected].frozen == false) {
					if (prevdefenderselected != defenderselected) {
						freezecounter = 0;
					}
					freezecounter = freezecounter + 1;
					if (freezecounter == 1) {
						messageclear();
						document.getElementById("resultatt").innerHTML = 'Opting to freeze ' + defenders[defenderselected].type + ' [' + (defenderselected + 1) + ']. Press on the same defender two more times to confirm.';
					} else if (freezecounter == 2) {
						messageclear();
						document.getElementById("resultatt").innerHTML = 'Opting to freeze ' + defenders[defenderselected].type + ' [' + (defenderselected + 1) + ']. Press on the same defender one more time to confirm.';
					} else if (freezecounter == 3) {
						messageclear();
						freezecounter = 0;
						document.getElementById("resultatt").innerHTML = 'Defender ' + defenders[defenderselected].type + ' [' + (defenderselected + 1) + '] frozen!';
						defenders[defenderselected].frozen = true;
						document.getElementById("defender" + defenderselected).style.borderColor = "blue";
					}
					prevdefenderselected = defenderselected;
				} else if (attackerselected == -1 && defenders[defenderselected].hp > 0 && defenders[defenderselected].frozen == true) {
					if (prevdefenderselected != defenderselected) {
						freezecounter = 0;
					}
					freezecounter = freezecounter + 1;
					if (freezecounter == 1) {
						messageclear();
						document.getElementById("resultatt").innerHTML = 'Opting to unfreeze ' + defenders[defenderselected].type + ' [' + (defenderselected + 1) + ']. Press on the same defender two more times to confirm.';
					} else if (freezecounter == 2) {
						messageclear();
						document.getElementById("resultatt").innerHTML = 'Opting to unfreeze ' + defenders[defenderselected].type + ' [' + (defenderselected + 1) + ']. Press on the same defender one more time to confirm.';
					} else if (freezecounter == 3) {
						messageclear();
						freezecounter = 0;
						document.getElementById("resultatt").innerHTML = 'Defender ' + defenders[defenderselected].type + ' [' + (defenderselected + 1) + '] unfrozen!';
						defenders[defenderselected].frozen = false;
						document.getElementById("defender" + defenderselected).style.borderColor = "black";
					}
					prevdefenderselected = defenderselected;
				}
				if (attackerselected != -1) {
					if ((defenders[defenderselected].hp > 0) && (attackers[attackerselected].unavailable == false)) {
						if ((attackers[attackerselected].type == "Fire Dragon") && (attackers[attackerselected].defendersattacked.length > 0)) {
							var alreadyattacked = false;
							for (i = 0; i < attackers[prevattackerselected].defendersattacked.length; i++) {
								if (defenderselected == attackers[attackerselected].defendersattacked[i]) {
									alreadyattacked = true;
								}
							}
							if (alreadyattacked == false) {
								calculate("Multi");
							}
						} else {
							calculate("Multi");
						}
						if ((attackers[attackerselected].type != "Knight") && (attackers[attackerselected].type != "Navalon") && (attackers[attackerselected].type != "Fire Dragon")) {
							attackerselected = -1;
							prevattackerselected = -2;
							prevdefenderselected = -1;
						} else if (attackers[attackerselected].type == "Fire Dragon") {
							if (attackers[attackerselected].unavailable == false) {
								var divselected = "attacker" + attackerselected;
								document.getElementById(divselected).style.borderColor = "green";
							} else {
								attackerselected = -1;
								prevattackerselected = -2;
								prevdefenderselected = -1;
							}
						} else {
							if (attackers[attackerselected].unavailable == false) {
								var divselected = "attacker" + attackerselected;
								document.getElementById(divselected).style.borderColor = "green";
							} else {
								attackerselected = -1;
								prevattackerselected = -2;
								prevdefenderselected = -1;
							}
						}
					}
				}
			}
		}

		function createbackup() {
			resetcounters();
			if (deleteselected == true) {
				deleteselected = false;
				document.getElementById("deletebutton").innerText = "Delete Units";
			}
			if (healselected == true) {
				healselected = false;
				document.getElementById("healbutton").innerText = "+2";
			}
			if ((attackers.length < 1) && (defenders.length < 1)) {
				messageclear();
				document.getElementById("resultatt").innerHTML = "At least one unit must be created before saving a state!";
				scrollanchor.scrollIntoView(false);
			} else {
				if ((attackerselected >= 0) && (attackers[attackerselected].type == "Fire Dragon") && (attackers[attackerselected].defendersattacked.length > 0)) {
					var splashindicator = "";
					var decshort = attackers[attackerselected].a;
					var divselected = "attacker" + attackerselected;
					attackers[attackerselected].unavailable = true;
					document.getElementById(divselected).style.borderColor = "gray";
					document.getElementById("attacker" + attackerselected).innerHTML = "<img src='images/Attackers/" + attackers[attackerselected].type + ".png' height='55' width='55'><div id='splash" + attackerselected +
						"' style='position: absolute; top: 1px; right: 1px'><b>" + splashindicator + "</b></div><div style='position: absolute; width: 100%; bottom: 2px; text-align: center'>" + decshort + "/" + attackers[attackerselected].hp + "/" + attackers[
							attackerselected].maxhp + "</div>";
					attackerselected = -1;
					prevattackerselected = -2;
				}
				backupattackers = [];
				backupdefenders = [];
				if (firstbackup == false) {
					firstbackup = true;
				}
				for (i = 0; i < attackers.length; i++) {
					backupattackers.push({
						type2: attackers[i].type,
						a2: attackers[i].a,
						hp2: attackers[i].hp,
						maxhp2: attackers[i].maxhp,
						unavailable2: attackers[i].unavailable,
						defendersattacked2: attackers[i].defendersattacked.slice(),
						originalhp2: attackers[i].originalhp
					});
				}
				for (i = 0; i < defenders.length; i++) {
					backupdefenders.push({
						type2: defenders[i].type,
						d2: defenders[i].d,
						hp2: defenders[i].hp,
						maxhp2: defenders[i].maxhp,
						defbonus2: defenders[i].defbonus,
						frozen2: defenders[i].frozen
					});
				}
				messageclear();
				document.getElementById("resultatt").innerHTML = "State saved!";
				scrollanchor.scrollIntoView(false);
			}
		}

		function loadbackup() {
			resetcounters();
			if (deleteselected == true) {
				deleteselected = false;
				document.getElementById("deletebutton").innerText = "Delete Units";
			}
			if (healselected == true) {
				healselected = false;
				document.getElementById("healbutton").innerText = "+2";
			}
			if (firstbackup == false) {
				messageclear();
				document.getElementById("resultatt").innerHTML = "No data available. A state must be saved first!";
				scrollanchor.scrollIntoView(false);
			} else {
				attackers = [];
				defenders = [];
				attackerselected = -1;
				prevattackerselected = -2;
				for (i = 0; i < backupattackers.length; i++) {
					attackers.push({
						type: backupattackers[i].type2,
						a: backupattackers[i].a2,
						hp: backupattackers[i].hp2,
						maxhp: backupattackers[i].maxhp2,
						unavailable: backupattackers[i].unavailable2,
						defendersattacked: backupattackers[i].defendersattacked2.slice(),
						originalhp: backupattackers[i].originalhp2
					});
				}
				for (i = 0; i < backupdefenders.length; i++) {
					defenders.push({
						type: backupdefenders[i].type2,
						d: backupdefenders[i].d2,
						hp: backupdefenders[i].hp2,
						maxhp: backupdefenders[i].maxhp2,
						defbonus: backupdefenders[i].defbonus2,
						frozen: backupdefenders[i].frozen2
					});
				}
				document.getElementById("attackerlist").innerHTML = "";
				var decshort = "";
				var splashindicator = ""
				color = "";
				for (i = 0; i < attackers.length; i++) {
					color = "black";
					if (attackers[i].type == "Knight") {
						decshort = "<b>3</b>";
					} else {
						decshort = attackers[i].a;
					}
					if ((attackers[i].hp < 1) || (attackers[i].unavailable == true)) {
						color = "gray";
					}
					splashindicator = ""
					if ((attackers[i].type == "Fire Dragon") && (attackers[i].defendersattacked.length > 0) && (attackers[i].unavailable != true)) {
						splashindicator = "S";
					}
					attackerlist.insertAdjacentHTML("beforeend", "<div class='c' id='attacker" + i + "' style='width: 56px; height: 80px; border-style: solid; border-color: " + color + "; display: inline-block; position: relative' onclick='attackselector(" + i +
						")'><img src='images/Attackers/" + attackers[i].type + ".png' height='55' width='55'><div id='splash" + i + "' style='position: absolute; top: 1px; right: 1px'><b>" + splashindicator +
						"</b></div><div style='position: absolute; width: 100%; bottom: 2px; text-align: center'>" + decshort + "/" + attackers[i].hp + "/" + attackers[i].maxhp + "</div></div>");
				}
				document.getElementById("defenderlist").innerHTML = "";
				for (i = 0; i < defenders.length; i++) {
					color = "black"
					if (defenders[i].hp < 1) {
						color = "gray";
					} else if (defenders[i].frozen == true) {
						color = "blue";
					}
					defenderlist.insertAdjacentHTML("beforeend", "<div class='c' id='defender" + i + "' style='width: 56px; height: 80px; border-style: solid; border-color: " + color + "; display: inline-block; position: relative' onclick='defenseselector(" +
						i + ")'><img src='images/Defenders/" + defenders[i].type + ".png' height='55' width='55'><div style='position: absolute; top: 1px; right: 1px'><b>" + defenders[i].defbonus +
						"</b></div><div style='position: absolute; width: 100%; bottom: 2px; text-align: center'>" + defenders[i].d + "/" + defenders[i].hp + "/" + defenders[i].maxhp + "</div></div>");
				}
				messageclear();
				document.getElementById("resultatt").innerHTML = "State loaded!";
				scrollanchor.scrollIntoView(false);
			}
		}

		function noretaldefault() {
			if (noretalswitch == true) {
				noretalswitch = false;
				messageclear();
				document.getElementById("resultatt").innerHTML = "Setting changed. Enemy units WILL retaliate on your ranged attacks by default.";
			} else {
				noretalswitch = true
				messageclear();
				document.getElementById("resultatt").innerHTML = "Setting changed. Enemy units WON'T retaliate on your ranged attacks by default.";
			}
		}

		function loadelements() {
			characterFill();
			document.getElementById("main").style.visibility = "visible";

			var queryStr = window.location.search;
			if (queryStr == "?short") {
				var hiddenelements = document.getElementsByClassName("shorthide");
				var i;
				for (i = 0; i < hiddenelements.length; i++) {
					hiddenelements[i].style.display = "none";
				}
				shortparameter = true;
				document.getElementById("shortatt").style.display = "inline";
				document.getElementById("shortdef").style.display = "inline";
				document.getElementById("shortlink").style.display = "none";
				document.getElementById("shorttext").style.display = "none";
			}
		}

		function expandcontainer(identifier) {
			var expandindicator = "expandindicator" + identifier;
			var answercontainer = "answercontainer" + identifier;

			if (document.getElementById(expandindicator).innerHTML == "+") {
				document.getElementById(expandindicator).innerHTML = "-";
				document.getElementById(answercontainer).style.display = "block";
				answersexpanded++;
				if (answersexpanded == 18) {
					document.getElementById("expandallindicator1").innerHTML = "- Collapse all";
					document.getElementById("expandallindicator2").innerHTML = "- Collapse all";
				}
			} else {
				document.getElementById(expandindicator).innerHTML = "+";
				document.getElementById(answercontainer).style.display = "none";
				answersexpanded--;
				if (answersexpanded > 0) {
					document.getElementById("expandallindicator1").innerHTML = "+ Expand all";
					document.getElementById("expandallindicator2").innerHTML = "+ Expand all";
				}
			}
		}

		function expandall(indicator) {
			if (document.getElementById("expandallindicator1").innerHTML == "+ Expand all") {
				var expandindicator = "";
				var answercontainer = "";

				for (i = 0; i < 20; i++) {
					expandindicator = "expandindicator" + i;
					answercontainer = "answercontainer" + i;
					if (document.getElementById(expandindicator).innerHTML == "+") {
						document.getElementById(expandindicator).innerHTML = "-";
						document.getElementById(answercontainer).style.display = "block";
					}
				}
				answersexpanded = 20;
				document.getElementById("expandallindicator1").innerHTML = "- Collapse all";
				document.getElementById("expandallindicator2").innerHTML = "- Collapse all";
				if (indicator == 2) {
					expandallindicator2.scrollIntoView(false);
				}
			} else {
				var expandindicator = "";
				var answercontainer = "";

				for (i = 0; i < 20; i++) {
					expandindicator = "expandindicator" + i;
					answercontainer = "answercontainer" + i;
					if (document.getElementById(expandindicator).innerHTML == "-") {
						document.getElementById(expandindicator).innerHTML = "+";
						document.getElementById(answercontainer).style.display = "none";
					}
				}
				answersexpanded = 0;
				document.getElementById("expandallindicator1").innerHTML = "+ Expand all";
				document.getElementById("expandallindicator2").innerHTML = "+ Expand all";
				if (indicator == 2) {
					expandallindicator2.scrollIntoView(false);
				}
			}
		}

		function refreshattackers() {
			var availabilitycheck = false;
			if (refreshcounter == 0) {
				for (i = 0; i < attackers.length; i++) {
					if ((attackers[i].unavailable == true) && (attackers[i].hp > 0)) {
						availabilitycheck = true;
						break;
					}
					if ((attackers[i].type == "Fire Dragon") && (attackers[i].unavailable == false) && (attackers[i].defendersattacked.length > 0)) {
						availabilitycheck = true;
						break;
					}
				}
			}
			if ((availabilitycheck == false) && (refreshcounter == 0)) {
				messageclear();
				document.getElementById("resultatt").innerHTML = "There are no valid attackers that can be refreshed.";
			} else if ((availabilitycheck == true) || (refreshcounter > 0)) {
				refreshcounter++;
				if (refreshcounter == 1) {
					messageclear();
					document.getElementById("resultatt").innerHTML = 'Opting to refresh all valid attackers. Press "Attackers:" two more times to confirm.';
				} else if (refreshcounter == 2) {
					messageclear();
					document.getElementById("resultatt").innerHTML = 'Opting to refresh all valid attackers. Press "Attackers:" one more time to confirm.';
				} else if (refreshcounter == 3) {
					for (i = 0; i < attackers.length; i++) {
						if ((attackers[i].unavailable == true) && (attackers[i].hp > 0)) {
							attackers[i].unavailable = false;
							attackers[i].defendersattacked = [];
							document.getElementById("attacker" + i).style.borderColor = "black";
						}
						if (document.getElementById("attacker" + i).style.borderColor == "green") {
							document.getElementById("attacker" + i).style.borderColor = "black";
							attackers[i].defendersattacked = [];
							if (attackers[i].type == "Fire Dragon") {
								document.getElementById("splash" + i).innerHTML = "<b> </b>";
								attackers[i].originalhp = attackers[i].hp;
							}
						}
					}
					if (deleteselected == true) {
						deleteselected = false;
						document.getElementById("deletebutton").innerText = "Delete Units";

					}
					attackerselected = -1;
					prevattackerselected = -2;
					refreshcounter = 0;
					messageclear();
					document.getElementById("resultatt").innerHTML = 'Attackers refreshed!';
				}
			}
		}
	</script>

	<noscript>
		<h2>Dungeon World Character Sheet</h2>
		<i style="display: inline-block">(by Godmar02)</i>
		<p>Javascript is required to use the calculator!</p>
		<p>If you are worried about potential security issues, you can always review the code at the project's <a href="https://github.com/godmar02/godmar02.github.io/index.html">GitHub repository</a>.</p>
	</noscript>
	<div id="main" style="visibility: hidden">
		<h2>Dungeon World Character Sheet</h2>
		<span style="display: inline-block"><i>(by Godmar02)</i></span>

		<form id="values" onsubmit="return false" onkeypress="if (document.getElementById('multibutton').innerText == 'Single') {return event.keyCode != 13;}">

			<div id="attvalues">

				<p>
					<label for="characterName">Name:</label>
					<input type="text" id="characterName">
				</p>

				<p>
					<label for="selectClass">Class:</label>
					<select id="selectClass" class="mselect" onchange="characterFill()" style="position: relative" tabindex="-1">
						<option value="Barbarian">Barbarian
						<option value="Bard">Bard
						<option value="Ranger">Ranger
						<option value="Thief">Thief
						<option value="Wizard">Wizard
					</select><br>
				</p>
				<p>
					<label for="selectRace">Race:</label>
					<select id="selectRace" class="mselect" onchange="characterFill()" style="position: relative" tabindex="-1">
						<option value="Dwarf">Dwarf
						<option value="Elf">Elf
						<option value="Goblin">Goblin
						<option value="Human">Human
					</select><br>
				</p>
				<p>
					<label for="selectAlignment">Alignment:</label>
					<select id="selectAlignment" class="mselect" onchange="characterFill()" style="position: relative" tabindex="-1">
						<option value="Chaotic">Chaotic
						<option value="Good">Good
						<option value="Neutral">Neutral
					</select>
				</p>

				<p>
					<label for="characterLevel">Level:</label>
					<input type="number" min="1" id="characterLevel"><br>

					<label for="characterXP">XP:</label>
					<input type="number" min="0" id="characterXP">

					<label for="characterArmour">XP:</label>
					<input type="number" min="0" id="characterArmour">

					<label for="characterDamage">XP:</label>
					<input type="text"  id="characterDamage" readonly>

					<br>
				</p>

				<br><br>

				<p>STR DEX CON INT WIS CHA</p>
				<label class="container" id="attveterancy" onclick="attackerveteran()" style="display: none; position: absolute; margin-left: 4px;">
					<span style="margin-right: 28px">Veteran?</span>
					<input type="checkbox" id="attvetbox" style="visibility: hidden">
					<span class="checkmark"></span>
				</label>

				<p class="shorthide" id="attvaluetext">Attacker attack value: <span id="attackrem" style="color: darkgray; visibility: hidden;"></span></p>
				<input type="number" id="attack" class="minput shorthide" onfocusin="numberfocus('attack')" onfocusout="numberfocusout('attack')" min="0" step="0.5" required tabindex="1">
				<p><span class="textpress" onclick="refreshatthp()">Current HP: </span><span id="attackhprem" style="color: darkgray; visibility: hidden;"></span></p>
				<input type="number" id="attackhp" class="minput" onfocusin="numberfocus('attackhp')" onfocusout="numberfocusout('attackhp')" min="1" required tabindex="2"><span id="shortatt" style="display: none; font-size: 17px; margin-left: 4px;"></span>

				<p class="shorthide" id="attmaxhptext">Max HP: <span id="attackmaxhprem" style="color: darkgray; visibility: hidden;"></span></p>
				<input type="number" id="attackmaxhp" class="minput shorthide" onfocusin="numberfocus('attackmaxhp')" onfocusout="numberfocusout('attackmaxhp')" min="10" required tabindex="3">
			</div>

		</form>

		<p id="states" style="display: none"><button type="button" class="mbutton" onclick="createbackup()">Save State</button>
			<button type="button" class="mbutton" onclick="loadbackup()">Load State</button>

		<div id="resultcontainer" onclick="displayextinfo()" style="max-width: 800px">
			<p><b id="result">Result:</b><span id="respressindicator">&#9679;</span></p>
			<p id="resultdef">For information on Character Sheet usage and useful guides or links, read the <a href="#top" onclick="return show('faq', 'main')" target="_top">FAQ</a>.</p>
			<p id="resultsplash"></p>
			<p id="frozennote" class="i"></p>
			<p id="note" class="i"></p>
			<span id="scrollanchor"></span>
			<p id="extendedinfo" class="ext" style="display:none"><span style="border-top: 1px dashed black; padding-top: 10px; display: block; max-width: 350px;"></span>Battle history does not contain any entries yet.</p>
		</div>
	</div>

	<div id="faq" style="display:none; max-width: 800px">
		<h2>Frequently Asked Questions</h2><br /><br />

		<p><a href="javascript:;" class="textpress" style="float: left" onclick="return show('main', 'faq')" target="_top">&lt;&lt;&lt; Back to the calculator!</a><a href="javascript:;" class="textpress" id="expandallindicator1" style="float: right"
				onclick="expandall(1)">+ Expand all</a></p>

		<div class="q" style="border-top: 1px solid; margin-top: 25px;" onclick="expandcontainer(0)">
			<div class="p"><b>How do I use the Character Sheet?</b></div>
			<div id="expandindicator0" class="ei">+</div>
		</div>
		<div id="answercontainer0" class="a">
			<p>TBC.</p>
		</div>

		<div class="q" onclick="expandcontainer(1)">
			<div class="p"><b>Can I use the Character Sheet offline?</b></div>
			<div id="expandindicator1" class="ei">+</div>
		</div>
		<div id="answercontainer1" class="a">
			<p>Yes you can. Follow these instructions:<br /><br />
				<i>Any platform</i>: If you don't quit your browser app, you should be able to use the Character Sheet without internet access as long as the browser stays in memory. The Character Sheet is a static website and doesn't require the use of
				bandwith. Otherwise, most desktop browsers support saving pages so you can store them offline for later use. Some mobile browsers like Chrome also support this.<br /><br />
				<i>PC</i>: Go to the Character Sheet website, right-click on any empty space and press Save as... or Save Page As... to get the index.html file. Alternatively, you can download the file from <a
					href="https://github.com/godmar02/godmar02.github.io" target="_blank">GitHub</a>. After you downloaded it, simply drag the .html file into your browser to run the Character Sheet.<br /><br />
				<i>iOS</i>: Repeat the PC process. Download an app called HTML Viewer Q by Spica. Connect your device to iTunes. In iTunes, select your device and go to File Sharing. Select HTML Viewer, press Add File and find the .html file you downloaded
				on your PC. Disconnect your device, run HTML Viewer and press on a book-like icon at the bottom right. Switch from Bookmarks to Files and select the downloaded .html file.<br /><br />
				<i>Android</i>: Repeat the PC process. If you used the PC, connect your device and transfer the .html file to it. Download the HTML Viewer app by Yogev Haham and run it. Press the paper-like icon at the upper right. Find and select the
				downloaded .html file, then press the browser view icon in the upper right.</p>
		</div>

		<div class="q" onclick="expandcontainer(2)">
			<div class="p"><b>Who are you?</b></div>
			<div id="expandindicator2" class="ei">+</div>
		</div>
		<div id="answercontainer2" class="a">
			<p>Never you mind.</p>
		</div>

		<div style="float: left; position: relative; top: 6px; width: 100%">
			<p><a href="javascript:;" class="textpress" id="expandallindicator2" style="float: right" onclick="expandall(2)">+ Expand all</a></p><br />

			<p style="margin-top: 16px">
				<b style="float: left; margin-top: 4px;">Links:</b><br />
				<a href="https://a-dungeon-world.fandom.com/wiki/A_Dungeon_World_Wiki" target="_blank">Wiki</a><br />
				<a href="https://www.reddit.com/r/DungeonWorld/" target="_blank">Reddit</a><br /><br />

				<a href="https://dungeon-world.com/" target="_blank">Official Game Website</a><br />
				<a href="https://a-dungeon-world.fandom.com/wiki/Free_Playbooks" target="_blank">Free Playbooks</a><br />
				<a href="https://drive.google.com/file/d/1O3-dNuIxoiVkIrH20LIzzA38r9sVsiEI/view?usp=sharing" target="_blank">Dungeon World First Edition by Sage LaTorra and Adam Koebel</a><br />
				<a href="https://drive.google.com/file/d/1uAJBlTFUbpPcNRBI7iHQ3eD2QT5Hxhu3/view?usp=sharing" target="_blank">Dungeon World Playbooks v2.0 Designed by Stefan Grambart</a><br />
				<a href="https://drive.google.com/file/d/1S2ntGyK17puyC01XfxSGIIaq-1w86gkd/view?usp=sharing" target="_blank">Truncheon World: The Truncated Dungeon World by Sage LaTorra and Adam Koebel</a><br /><br />

				<a href="https://github.com/godmar02/godmar02.github.io" target="_blank">My GitHub</a><br />
				<a href="https://github.com/godmar02/godmar02.github.io/blob/master/Changelog.md" target="_blank">Changelog</a><br /><br />

				<a href="javascript:;" class="textpress" onclick="return show('main', 'faq')" target="_top">&lt;&lt;&lt; Back to the Character Sheet!</a></p><br />
		</div>
	</div>
</body>

</html>
